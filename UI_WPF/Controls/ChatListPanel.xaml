<UserControl x:Class="Another_Mirai_Native.UI.Controls.ChatListPanel"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:ui="http://schemas.modernwpf.com/2019"
             xmlns:controls="clr-namespace:Another_Mirai_Native.UI.Controls"
             xmlns:converter="clr-namespace:Another_Mirai_Native.UI.Converters"
             xmlns:local="clr-namespace:Another_Mirai_Native.UI.Controls"
             mc:Ignorable="d" 
             d:DesignHeight="450" d:DesignWidth="200">
    <UserControl.Resources>
        <converter:WidthConverter x:Key="WidthConverter" />
    </UserControl.Resources>
    <ui:ScrollViewerEx>
        <Border>
            <StackPanel>
                <TextBlock x:Name="EmptyHint"
                           Margin="10"
                           TextAlignment="Center"
                           Visibility="{Binding EmptyHintVisibility, RelativeSource={RelativeSource AncestorType=local:ChatListPanel}}">
                    空空如也喵~
                </TextBlock>
                <ListView x:Name="ChatListDisplay"
                          Margin="0,10"
                          HorizontalContentAlignment="Stretch"
                          ItemsSource="{Binding ItemsSource, RelativeSource={RelativeSource AncestorType=local:ChatListPanel}}"
                          SelectedItem="{Binding SelectedItem, RelativeSource={RelativeSource AncestorType=local:ChatListPanel}, Mode=TwoWay}"
                          SelectionChanged="ChatListDisplay_SelectionChanged">
                    <ListView.ItemTemplate>
                        <DataTemplate>
                            <controls:ChatListItem
                                MaxWidth="{Binding ActualWidth, ElementName=ChatListDisplay, Converter={StaticResource WidthConverter}, ConverterParameter={x:Static SystemParameters.VerticalScrollBarWidth}}"
                                Margin="0,10"
                                HorizontalAlignment="Stretch"
                                VerticalAlignment="Center"
                                Item="{Binding}" />
                        </DataTemplate>
                    </ListView.ItemTemplate>
                </ListView>
            </StackPanel>
        </Border>
    </ui:ScrollViewerEx>
</UserControl>
